<!doctype html>
<html>
<head>
  <title>Donation Form Demo</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="assets/style.css" />

  <style>
    body {
      color: #333;
      font-family: sans-serif;
    }

    body.modal-manager-open {
      overflow: hidden;
    }

    modal-manager {
      display: none;
      --modalTopMargin: 4rem;
      --modalBottomMargin: 0.25rem;
    }

    modal-manager[mode='open'] {
      display: block;
    }

    donation-form-controller {
      display: block;
      width: 32rem;
    }

    .dev-tools {
      background-color: lightblue;
      padding: 1rem 1rem;
    }

    #paypal-upsell-button {
      opacity: 0.01;
      padding-bottom: 0.6rem;
    }

    donation-form-controller.custom-colors {      
      /* CSS vars to set */
      /* Donate Button */
      --donateButtonColor: pink;
      --donateButtonTextColor: rebeccapurple;
      --donateButtonHoverColor: deepskyblue;

      /* Credit Card Button */
      --ccButtonFontColor: darkblue;
      --ccButtonColor: coral;

      /* Form Background color */
      --donateFormBgColor: turquoise;

      /* Form Text color */
      --donateFormTextColor: darkblue;

      /* Flow Badges Background color `(1), (2), (3)` */
      --donateFormBadgeBgColor: pink;
      /* Flow Badges Text color `(1), (2), (3)` */
      --donateFormBadgeTextColor: rebeccapurple;

      /* Form Options Background color `[$5], [$10], [monthly]` */
      --donateFormPaymentOptionTextColor: darkblue;
      /* Form Options Text color `[$5], [$10], [monthly]` */
      --donateFormPaymentOptionBgColor: lightblue;

      /* Selected Option Background color `[$5], [$10], [monthly]` */
      --monthlyFormGreen: green;
      /* Selected Option Text color `[$5], [$10], [monthly]` */
      --donateFormSelectedOptionTextColor: yellow;
    }

  div#options {
    display: flex;
    flex-wrap: wrap;
    justify-content: flex-end;
    align-items: center;
  }
  div#options button {
    margin: 2px 5px;
  }


  /* custom */

  ul {
    list-style-type: none;
  }

  iaux-mgc-subscription-summary ul li {
    border: 1px solid green;
    background-color: 
  }

  /* button  */

  .ia-button {
    min-height: 3rem;
    border: none;
    cursor: pointer;
    color: #fff;
    line-height: normal;
    border-radius: .4rem;
    text-align: center;
    vertical-align: middle;
    font-size: 1.4rem;
    display: inline-block;
    padding: .6rem 1.2rem;
    border: 1px solid transparent;

    white-space: nowrap;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -o-user-select: none;
    user-select: none;
  }

  .ia-button:disabled,
  .ia-button.disabled {
    cursor: not-allowed;
    opacity: 0.5;
  }

  .ia-button.transparent {
    background-color: transparent;
  }

  .ia-button.slim {
    padding: 0;
  }

  .ia-button.primary {
    background-color: #194880;
    border-color: #c5d1df;
  }

  .ia-button.cancel {
    background-color: #e51c26;
    border-color: #f8c6c8;
  }

  </style>

</head>
<body>
  <header>
    <a href="recaptcha.html">Recaptcha Demo</a>
  </header>

  <div class="dev-tools">
    <div id="options">
    </div>
    <p><b>Latest analytic event: </b><span id="latest-analytic"></span></p>
    <div>
      <form id="preload-email">
        <label for="email"><b>Pre-load Email:</b></label>
          <input type="email" id="email" name="email" required>
        <button type="submit">Preload Email</button>
        <button id="clear-email">Clear Email</button>
      </form>
      <br>
      <button id="load-summaries">Load multiple Summaries</button>
    </div>
  </div>

  <div id="demo">
    <iaux-monthly-giving-circle></iaux-monthly-giving-circle>
  </div>

  <script type="module">
    import '../dist/src/monthly-giving-circle.js';
    import SubscriptionSummary from '../dist/src/models/subscription-summary.js';
    import { LazyLoaderService } from '@internetarchive/lazy-loader-service';

    const lazyLoader = new LazyLoaderService();

    lazyLoader.on(
      'scriptLoadRetried',
      async (src, retryNumber) => {
        console.debug('scriptLoadRetried', src, retryNumber);
      },
    );

    lazyLoader.on('scriptLoadFailed', async (src) => {
      console.debug('scriptLoadFailed', src);
    });

    const webComponent = document.querySelector('iaux-monthly-giving-circle');
    const loadSummariesButton = document.querySelector('#load-summaries');

    const x = await fetch('./data.json');
    const data = await x.json();
    const allSubscriptions = data.value;
    console.log(data);
    window.data = data;

    // get keys
    const keys = Object.keys(data.value);
    // make array of summaries
    const summaries = keys.map((id) => {
      const _summary = allSubscriptions[id];
      const summary = new SubscriptionSummary({ ..._summary, id });
      console.log('Summary payment data', summary.payment);
      return summary;
    });

    console.log('Summaries!', summaries);
    window.summaries = summaries

    loadSummariesButton.addEventListener('click', async () => {
      webComponent.activePlans = summaries;
      webComponent.giverId = 'giver-123';
    });
</script>
</body>
</html>
