<!doctype html>
<html>
<head>
  <title>Donation Form Demo</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="assets/style.css" />

  <style>
    body {
      color: #333;
      font-family: sans-serif;
    }

    body.modal-manager-open {
      overflow: hidden;
    }

    modal-manager {
      display: none;
      --modalTopMargin: 4rem;
      --modalBottomMargin: 0.25rem;
    }

    modal-manager[mode='open'] {
      display: block;
    }

    donation-form-controller {
      display: block;
      width: 32rem;
    }

    .dev-tools {
      background-color: lightblue;
      padding: 1rem 1rem;
    }

    #paypal-upsell-button {
      opacity: 0.01;
      padding-bottom: 0.6rem;
    }

  div#options {
    display: flex;
    flex-wrap: wrap;
    justify-content: flex-end;
    align-items: center;
  }
  /* div#options button {
    margin: 2px 5px;
  } */


  /* custom */

  /* button  */

  .ia-button {
    min-height: 3rem;
    border: none;
    cursor: pointer;
    color: #fff;
    line-height: normal;
    border-radius: .4rem;
    text-align: center;
    vertical-align: middle;
    font-size: 1.4rem;
    display: inline-block;
    padding: .6rem 1.2rem;
    border: 1px solid transparent;

    white-space: nowrap;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -o-user-select: none;
    user-select: none;
  }

  .ia-button:disabled,
  .ia-button.disabled {
    cursor: not-allowed;
    opacity: 0.5;
  }

  .ia-button.transparent {
    background-color: transparent;
  }

  .ia-button.slim {
    padding: 0;
  }

  .ia-button.primary {
    background-color: #194880;
    border-color: #c5d1df;
  }

  .ia-button.cancel {
    background-color: #e51c26;
    border-color: #f8c6c8;
  }

  #demo {
    max-width: 500px;
  }

  /**/
  iaux-monthly-giving-circle  h2 {
    margin: 0;
    font-size: 1.5em;
  }

  iaux-monthly-giving-circle button {
    background: none;
    color: #4b64ff;
    border: none;
    cursor: pointer;
    padding-left: 0;
    padding-right: 0;
    font-size: 1rem;
  }

  iaux-monthly-giving-circle .heart-icon {
    display: inline-block;
    width: 2rem;
    height: 2rem;
    fill: rgb(255, 0, 0);
  }


  iaux-monthly-giving-circle .mgc-title {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-content: center;
    margin: 0;
    justify-content: space-between;
    align-items: flex-end;
  }


  iaux-monthly-giving-circle .mgc-title .heart-label {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-content: flex-end;
    align-items: flex-end;
    justify-content: flex-start;
  }

  iaux-monthly-giving-circle {
    display: block;
    width: inherit;
    --background-color: #EEFFEE;
    --border-color: #23765D:
  }

  iaux-mgc-welcome {
    margin-top: .5rem;
    padding: 0 .5rem;
    border: 1px solid #23765D;
    background-color: #EEFFEE;
    display: block;
    width: inherit;
  }

  iaux-mgc-welcome button.click-to-join {
    font-size: inherit;
  }

  iaux-mgc-subscription-summary {
    display: block;
    width: inherit;
    --background-color: #EEFFEE;
    --border-color: #23765D:
  }

  iaux-mgc-subscription-summary ul {
    padding: 0;
    list-style-type: none;
  }

  iaux-mgc-subscription-summary ul li {
    border: 1px solid #23765D;
    background-color: #EEFFEE;
    margin: .5rem;
    padding: .5rem;
  }

  iaux-mgc-subscription-summary ul li .info {
    display:flex;
    margin: .5rem;
    padding: .5rem;
  }

  iaux-mgc-subscription-summary ul li .info > div {
    flex-grow: 1;
    flex-basis: 0;
  }


  </style>

</head>
<body>
  <header>
    <a href="recaptcha.html">Recaptcha Demo</a>
  </header>

  <div class="dev-tools">
    <div id="options">
    </div>
    <p><b>Latest analytic event: </b><span id="latest-analytic"></span></p>
    <div>
      <form id="preload-email">
        <label for="email"><b>Pre-load Email:</b></label>
          <input type="email" id="email" name="email" required>
        <button type="submit">Preload Email</button>
        <button id="clear-email">Clear Email</button>
      </form>
      <br>
      <button id="load-summaries">Load multiple Summaries</button>
    </div>
  </div>

  <div id="demo">
    <iaux-monthly-giving-circle></iaux-monthly-giving-circle>
  </div>

  <script type="module">
    import '../dist/src/monthly-giving-circle.js';
    import SubscriptionSummary from '../dist/src/models/subscription-summary.js';
    import { LazyLoaderService } from '@internetarchive/lazy-loader-service';

    const lazyLoader = new LazyLoaderService();

    lazyLoader.on(
      'scriptLoadRetried',
      async (src, retryNumber) => {
        console.debug('scriptLoadRetried', src, retryNumber);
      },
    );

    lazyLoader.on('scriptLoadFailed', async (src) => {
      console.debug('scriptLoadFailed', src);
    });

    const webComponent = document.querySelector('iaux-monthly-giving-circle');
    const loadSummariesButton = document.querySelector('#load-summaries');

    const x = await fetch('./demo/data.json');
    const data = await x.json();
    const allSubscriptions = data.value;
    console.log(data);
    window.data = data;

    // get keys
    const keys = Object.keys(data.value);
    // make array of summaries
    const summaries = keys.map((id) => {
      const _summary = allSubscriptions[id];
      const summary = new SubscriptionSummary({ ..._summary, id });
      console.log('Summary payment data', summary.payment);
      return summary;
    });

    console.log('Summaries!', summaries);
    window.summaries = summaries

    loadSummariesButton.addEventListener('click', async () => {
      webComponent.activePlans = summaries;
      webComponent.giverId = 'giver-123';
    });
</script>
</body>
</html>
